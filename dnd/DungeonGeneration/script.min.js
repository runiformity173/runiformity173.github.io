let MULT=0;class matrix_element{constructor(e,t){this.row=e,this.col=t}}function printDistance(e){if(0==MULT)return[e,1];var t=e.map((function(e){return e.slice()}));let n=t.length,r=t[0].length,a=[];for(let e=0;e<n;e++)for(let n=0;n<r;n++)0==t[e][n]&&a.push(new matrix_element(e,n));let o=a.length;for(let e=0;e<n;e++)for(let n=0;n<r;n++){let r=0,l=Number.MAX_VALUE;if(1==t[e][n])for(let d=0;d<o;d++){let o=a.shift(),d=o.row,i=o.col;if(r=Math.pow(d-e,2)+Math.pow(i-n,2),l=Math.min(l,r),1==l){t[e][n]=1,a.push(new matrix_element(d,i));break}a.push(new matrix_element(d,i)),t[e][n]=Math.round(l)}else t[e][n]=0}var l=t.map((function(e){return Math.max.apply(Math,e)}));return[t,Math.max.apply(null,l)]}function blendHex(e,t,n){const r=parseInt(t.substring(0,2),16),a=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16),l=parseInt(e.substring(0,2),16),d=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16);let u=Math.round(r*n+l*(1-n)),c=Math.round(a*n+d*(1-n)),s=Math.round(o*n+i*(1-n));u=u>255?255:u,c=c>255?255:c,s=s>255?255:s;return"#"+u.toString(16).padStart(2,"0")+c.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")}function display(e){let t=[WALL],n=e[0],r=e[1];for(let e=1;e<r+1;e++)e<=MULT?t.push(blendHex(WALL.replace("#",""),FLOOR.replace("#",""),e/MULT)):t.push(FLOOR);document.getElementById("board-container").remove();const a=document.createElement("div");a.id="board-container",a.style.gridTemplateColumns="repeat("+WIDTH+", "+640/WIDTH+"px)",a.style.gridTemplateRows="repeat("+HEIGHT+", "+(640/HEIGHT/(WIDTH/HEIGHT))+"px)";for(let e=0;e<HEIGHT;e++)for(let r=0;r<WIDTH;r++){const o=document.createElement("div");o.style.backgroundColor=t[n[e][r]],a.appendChild(o)}document.getElementById("container-container").appendChild(a)}let HEIGHT=128,WIDTH=128,NOISE=.5,SAMPLE_RANGE=3,WALL="#212529",FLOOR="#bbbbbb";function boardWithNoise(e,t,n){const r=Array.from({length:t},(()=>[]));for(let a=0;a<t;a++)for(let t=0;t<n;t++)r[a].push(e>Math.random()?0:1);return r}function change(e,t,n,r,a,o,l=!1){if(!l){let l,d,i=0,u=0;for(let c=-o;c<=o;c++)for(let s=-o;s<=o;s++)l=e+c,d=t+s,l===e&&d===t||(l>=o&&l<a-o&&d>=o&&d<r-o?0===n[d][l]?i++:u++:i++);return i>Math.floor((2*o+1)**2/2)?0:1}}function update(e,t,n,r){if(r>0){const a=e.map((e=>[...e]));for(let o=0;o<t;o++)for(let l=0;l<n;l++)a[o][l]=change(l,o,e,t,n,r);return a}return e}let board=boardWithNoise(NOISE,HEIGHT,WIDTH);function start(){let e=document.querySelector('input[name="sample-range"]:checked').value;HEIGHT=Number(document.getElementById("height").value),WIDTH=Number(document.getElementById("width").value),document.getElementById("height").disabled=!0,document.getElementById("width").disabled=!0,SAMPLE_RANGE=Math.round((HEIGHT+WIDTH)/2)/{Medium:32,Small:64,Large:16}[e],WALL=document.getElementById("wall").value,FLOOR=document.getElementById("floor").value,MULT=HEIGHT>128||WIDTH>128?0:9,board=boardWithNoise(NOISE,HEIGHT,WIDTH),board=update(board,HEIGHT,WIDTH,SAMPLE_RANGE),board=update(board,HEIGHT,WIDTH,SAMPLE_RANGE),display(printDistance(board)),document.querySelector("#run").onclick=function(){board=update(board,HEIGHT,WIDTH,SAMPLE_RANGE),display(printDistance(board))},document.querySelector("#run").innerHTML="Smooth",document.querySelector("#render").onclick=function(){display(printDistance(board))},document.querySelector("#render").style.display="inline",document.querySelector("#rerun").style.display="inline"}function generate(){board=update(board,HEIGHT,WIDTH,SAMPLE_RANGE),display(printDistance(board))}function render(){display(printDistance(board))}function load2(){if(location.href.includes("?")){let e=JSON.parse(atob(location.search.replace("?data=","")));document.getElementById("height").value=e.height,document.getElementById("width").value=e.width,document.getElementById("height").disabled=!1,document.getElementById("width").disabled=!1,document.querySelector("input[value='"+e["sample-range"]+"']").checked=!0,document.getElementById("wall").value=e.wall,document.getElementById("floor").value=e.floor}}function regenerate(){let e=JSON.stringify({height:HEIGHT,width:WIDTH,"sample-range":document.querySelector('input[name="sample-range"]:checked').value,wall:WALL,floor:FLOOR});e=btoa(e),window.location.replace(location.href.replace(location.search,"")+"?data="+e)}